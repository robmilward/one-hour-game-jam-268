pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
home={
 x=64,
 y=64,
 coins=0
}

player={
 x=64,
 y=64,
 lives=3,
 coins=0,
 at_home=1
}

coins={}

enemies={}


function draw_coins()
	for coin in all(coins) do
	 print("‚óè", coin.x, coin.y, 10)
	end
end

function draw_enemies()
	for enemy in all(enemies) do
		print("üòê", enemy.x, enemy.y, 8)
	end
end

function _update()
 if (btn(0)) then player.x=player.x-1 end
 if (btn(1)) then player.x=player.x+1 end
 if (btn(2)) then player.y=player.y-1 end
 if (btn(3)) then player.y=player.y+1 end

 detect_collisions()
 update_enemies()
end

function update_enemies()
 for enemy in all(enemies) do
  if(enemy.d == 1) then
   enemy.x=enemy.x+1	  
  elseif (enemy.d == 2) then
   enemy.x=enemy.x-1
  elseif (enemy.d == 3) then
			enemy.y=enemy.y+1
  else
  	enemy.y=enemy.y-1
		end
		
		if(enemy.x<=0) then
		 enemy.d=1
		end
		if(enemy.x>=120) then
		 enemy.d=2
		end		
		if(enemy.y<=0) then
		 enemy.d=3
		end
		if(enemy.y>=120) then
		 enemy.d=4
		end		
		
--		if (colliding(enemy,home,15) then
--   if(enemy.d == 1)
--		end
		
 end
end

function colliding(a, b, e)
 xhit=abs(a.x-b.x) <= e
 yhit=abs(a.y-b.y) <= e
 
 return (xhit and yhit)
end 

function _draw()
	cls()
	print(player.coins.." coin(s), "..home.coins.." safe, "..player.lives.." lives", 0, 0)
	rect(58, 58, 76, 76, 3)
	print("‚åÇ", home.x, home.x, 11)
	spr(1, player.x, player.y)
	
	draw_coins()
	draw_enemies()
end


-->8
function detect_collisions()
 pickup_coins()
 
 enemy_collide() 
 
 enter_home() 
end

function pickup_coins()
 for coin in all(coins) do
  if(colliding(coin, player, 5)) then
   sfx(0)
   del(coins, coin)
   player.coins=player.coins+1
  end
 end
end

function enemy_collide()
	for enemy in all(enemies) do
  if(colliding(enemy, player, 5)) then
   sfx(2)
   player.coins=0
   player.at_home=1
   player.x=home.x
   player.y=home.y
   player.lives=player.lives-1
  end
 end
end

function enter_home()
	if(colliding(player,home,10)) then
 	if(player.at_home == 0) then
  	sfx(1)
  	generate_coins()
 	end	
 	player.at_home=1
  if(player.coins > 0) then
	  home.coins=home.coins+player.coins
	  player.coins=0
  end
 else
  player.at_home=0
 end
end	
-->8
function generate_coins()
	coins={}
 for i=0,10 do	 
	 _coin={
	  x=ceil(rnd(120)),
	  y=ceil(rnd(120))
	 }
	
	 add(coins, _coin)
	end
end

function generate_enemies()
 for i=0,10 do	
	 repeat
		 _enemy={
		  x=ceil(rnd(120)),
		  y=ceil(rnd(120)),
		  d=flr(rnd(4))+1
		 }
 	until (not colliding(_enemy,home,15))
	
	 add(enemies, _enemy)
	end
end

generate_coins()
generate_enemies()
__gfx__
0000000000bbb00000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000bbbbb000aaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700007f7000aaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000fff000aaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000f111f00aaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700001110000aaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000011100000aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
88800000088008808880880008000880080000000000888000000880888088808880000000008880000080008880808088800880000000000000000000000000
80800000800080800800808080008000008000000000808000008000808080008000000000000080000080000800808080008000000000000000000000000000
8080000080008080080080808000888000888888880080800000888088808800880000000000088000008000080080808800888000000000aaa0000000000000
8080000080008080080080808aaa00800088088808008080000000808080800080000800000000800000800008008880800000800000000aaa0a000000000000
888000000880880088808080aaa0a8000808888888008880000088008080800088808000000088800000888088800800888088000000000aaaaa000000000000
000000000000000000000000aaaaa0000008000008000000000000000000000000000000000000000000000000000000000000000000000aaaaa000000000000
000000000000000000000000aaaaa000000888888800000000000000000000088888880000000000000000000000000000000aaa00000000aaa0000000000000
0000000000000000000000000aaa000000000000000000000000000000000008088808000000000000000000000000000000aaa0a00000000000000000000000
0000000000000000000000000000000000000000000000000000000000000008888888000000000000000000000000000000aaaaa00000000000000000000000
0000000000000000000000000000000000000000000000000000000000000008000008000000000000000000000000000000aaaaa00000000000000000000000
00000000000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000aaa000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000808880800000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000800000800000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000aaa000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aaa0a00000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000008a888a80000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000080000080000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaa0000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaa0a000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaaaa000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaaaa000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaa00000000000000000000000000aaa00000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaa0a0000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaaaa0000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaaaa0000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000aaa00000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080888080000000000000000000000000000000
00000000000000000000000000088888880000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000
00000000000000000000000000080888a8a000000000000000000000000000000000000000000000000000000080000080000000000000000000000000000000
0000000000000000000000000008888888a000000000000000000000000000000000000000000000000000000088888880000000000000000000000000000000
000000000000000000000000000800aaa8a000000000000000000000003333333333333333333000000000000000000000000000000000000000000000000000
00000000000000000000000000088888880000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000aaa0a0000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000aaaaa0000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000aaaaa0000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
000000000000000000000000000000aaa00000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000030000000bbb00000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000bbbbb0000003000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000300000bb7f7bb000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000bfffb0000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000f111f0000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000011100000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000011100000003000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000030000000a0a00000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003000000000000000003000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000030000000aaa00000003000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000003333333aaa3a3333333000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000aaaaa0000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000aaaaa0000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000aaa00000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000808880800000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000800000800000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000808880800000000000000000000000000000000000000
00000000000000000000000000000000000888888800000000000000000000000000000000000000000888888800000000000000000000000000000000000000
00000000000000000000000000000000000808880800000000000000000000000000000000000000000800000800000000000000000000000000000000000000
00000000000000000000000000000000000888888800000000000000000000000000000000000000000888888800000000000000000000000000000000000000
00000000000000000000000000000000000800000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000888888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000008888888000000000000000000000000000000000000000000000aaa0000000000000000000000000000
0000000000000000000000aaa00000000000000000000808880800000000000000000000000000000000000000000000aaa0a000000000000000000000000000
000000000000000000000aaa0a0000000000000000000888888800000000000000000000000000000000000000000000aaaaa000000000000000000000000000
000000000000000000000aaaaa0000000000000000000800000800000000000000000000000000000000000008888888aaaaa000000000000000000000000000
000000000000000000000aaaaa00000000000000000008888888000000000000000000000000000000000000080888080aaa0000000000000000000000000000
0000000000000000000000aaa0000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000800000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000888888800000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__sfx__
000100001015011150101501015010150101501014011140121401314016140181501d15024150371503715000100001000010000100001000010000100001000010000100001000010000100001000010000100
00010000110500f0500e0500d0500c0500b0500b0500a0500a0500a05009050090500a0500a0500a0500b0500c0500d0500e0501005011050130501505017050180501a0501b0501d0502005023050270502d050
000100001c3502035022350273502b3502d35030350313502a350233501e3501c3501c3501d3501e350203502335024350233501f3501b3501b3501c3501e3502035021350213501e3501b350163501335012350
__music__
00 01424344

